<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css"/>
      <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <title>Document</title>
  </head>
  <body>
    <main >
      <section id="main-container" class="main-container">
        <div id="form-wrapper" class="form-wrapper">
          <h3>Welcome <br>Please enter valid info</h3>
          <div class="form-group" id="username-group">
            <label for="username" class="form-label">Username:</label>
            <input type="text" id="username" class="form-input" />
            <small class="error-message" id="username-error"></small>

            <label for="email" class="form-label">Email:</label>
            <input type="email" id="email" class="form-input" />
            <small class="error-message" id="email-error"></small>

            <label for="password" class="form-label">Password:</label>
            <input type="password" id="password" class="form-input" />
            <small class="error-message" id="password-error"></small>
            <button
              id="submit_btn"
              type="submit"
              class="submit_bt"
              onclick="validUserForm()"
            >
              Submit
            </button>
          </div>
        </div>
      </section>

      <section id="second_section">
        <div
          class="relative overflow-x-auto bg-neutral-primary-soft shadow-xs rounded-base border border-default"
        >
          <table class="w-full text-sm text-left rtl:text-right text-body">
            <thead
              class="text-sm text-body bg-neutral-secondary-soft border-b rounded-base border-default"
            >
              <tr>
                <th scope="col" class="px-6 py-3 font-medium">ID</th>
                <th scope="col" class="px-6 py-3 font-medium">Email</th>
                <th scope="col" class="px-6 py-3 font-medium">Username</th>
                <th scope="col" class="px-6 py-3 font-medium">Password</th>
                <th scope="col" class="px-6 py-3 font-medium">FullName</th>
                <th cope="col" class="px-6 py-3 font-medium">Address</th>
                <th cope="col" class="px-6 py-3 font-medium">Phone</th>
                <th cope="col" class="px-6 py-3 font-medium">Action</th>
              </tr>
            </thead>
            <tbody id="texture">
            </tbody>
          </table>
        </div>
      </section>
    </main>

    <script>
      let userData = document.getElementById("username");
      let userEmail = document.getElementById("email");
      let userPassword = document.getElementById("password");

      let usenameError = document.getElementById("username-error");
      let emailError = document.getElementById("email-error");
      let password_error = document.getElementById("password-error");

      let insertData=document.getElementById("texture")

      function validUserForm() {
        let username = userData.value;
        let email = userEmail.value;
        let password = userPassword.value;

        if (username==="") {
          usenameError.innerHTML = "This field required<br>";
        }
        if (email==="") {
          emailError.innerHTML = "This field required<br>";
        }
        if (password === "") {
          password_error.innerHTML = "This field required<br>";
        }
        const data = { username, email, password };
        userRegister(data);
      }

      async function userRegister(value) {
        try {
          const response = await fetch("https://fakestoreapi.com/users", {
            method: "POST",
            headers: { "content-type": "application/json" },
            body: JSON.stringify(value),
          });

          if (!response.ok) {
            alert(response.ok);
          } else {
            alert("You are register");
          }
        } catch (error) {
          console.log(error);
        }
      }


      function renderingTemplate(userData){
        return `<tr class="bg-neutral-primary border-b border-default">
                <td scope="row" class="px-6 py-4 font-medium text-heading whitespace-nowrap">${userData.id}</td>
                <td class="px-6 py-4">${userData.email}</td>
                <td class="px-6 py-4">${userData.username}</td>
                <td class="px-6 py-4">${userData.password}</td>
                <td class="px-6 py-4">${userData.name.firstname} ${userData.name.lastname}</td>
                <td class="px-6 py-4">${userData.address.city} ${userData.address.street}</td>
                <td class="px-6 py-4">${userData.phone}</td>
                <td class="px-6 py-4" id="remover">
                  <button type="submit"  style="width:70px;  padding:8px 10px; border:3px solid rgb(2, 34, 34); border-radius:4px; cursor:pointer;" onclick=dataDelete(${userData.id})>Delete</button></td>
              </tr>`
      }

      async function fetchUserData() {
        try {
          const response=await fetch("https://fakestoreapi.com/users",{method:"GET"})
          const userData=await response.json()

          const userDataValid=userData.map((data)=>{
            return  renderingTemplate(data)
          })

          insertData.innerHTML=userDataValid.join("")
          
        } catch (error) {
          console.log(error)
        }
        
      }

      function dataDelete(userId){
        console.log("Button is clicked")
        removeUser(userId)
      }
      async function removeUser(id) {
        try {
          const response=await fetch(`https://fakestoreapi.com/users/${id}`,{
            method:"DELETE"
          })
          if(!response.ok){
            alert("Response error")
          }
          document.getElementById("remover").remove()
        } catch (error) {
          alert(error)
        }
      }

      fetchUserData()

      

    </script>
  </body>
</html>
